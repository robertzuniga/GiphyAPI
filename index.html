<!-- Robert Zuniga -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Giphy Search</title>
  <link rel="stylesheet" type="text/css" href="assets/css/style.css">
  </script>
  <script src="assets/javascript/javascript.js"></script>
</head>


<body>
  <div class="container">

    <h1>Giphy Search</h1>
    <!-- Rendered Buttons will get Dumped Here  -->
    <div id="buttons-view"></div>

    <form id="animal-form">
      <label for="animal-input">Add an Animal</label>
      <input type="text" id="animal-input"><br>
      <!-- Button triggers new animal to be added -->
      <input id="add-animal" type="submit" value="Click to Add">
    </form>

    <hr>
    <!-- Animal Giphy will Get Dumped Here -->
    <div id="images"> </div>

    <div id="animal-view"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  </div>
</body>

</html>

<script>
  // Initial array of topics
  var topics = ["dog", "cat", "rabbit", "hamster", "skunk", "goldfish", "bird", "ferret", "turtle", "sugar glider",
    "chinchilla",
    "hedgehog", "hermit crab", "gerbill", "pigmy goat", "chicken", "capybara", "salamander", "frog"
  ];
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Function for dumping the JSON content for each button into the div
  function displayAnimalInfo() {

    var animal = $(this).attr("data-name");
    console.log("animal ==> ", animal);
    var queryURL = "https://api.giphy.com/v1/gifs/search?api_key=ZGFCXW4DL8GQr4WH9ycZuksvEfPaRaHm&q=" + animal +
      "&limit=10";

    console.log("queryURL string ==>", queryURL);

    $.ajax({
      url: queryURL,
      method: "GET"
    }).then(function (response) {
        console.log("Response ==> ", response);
        console.log("Response.data.length ==>", response.data.length);


        for (var i = 0; i < response.data.length; i++) {
          var animalDiv = $("<div>");
          var p = $('<p>').text("Rating: " + response.data[i].rating);

          console.log("Rating ==> ", response.data[i].rating);
          var animalImage = $("<img>");
          animalImage.attr('src', response.data[i].images.fixed_height_still.url);

          animalDiv.append(animalImage);
          animalDiv.append(p);
          $("#images").prepend(animalDiv);
        }

      }
      // Saving the image_original_url property
    );
  } // end function displayAnimal image and info
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  // Function for displaying animal data
  function renderButtons() {
    // Deleting the buttons prior to adding new topics
    // (this is necessary otherwise you will have repeat buttons)
    $("#buttons-view").empty();
    // Looping through the array of topics
    for (var i = 0; i < topics.length; i++) {
      // Then dynamically generating buttons for each animal in the array
      // This code $("<button>") is all jQuery needs to create the beginning and end tag. (<button></button>)
      var a = $("<button>");
      // Adding a class of animal to our button
      a.addClass("animal");
      // Adding a data-attribute
      a.attr("data-name", topics[i]);
      // Providing the initial button text
      a.text(topics[i]);
      // Adding the button to the buttons-view div
      $("#buttons-view").append(a);
    }
  } // end function renderButtons 
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // This function handles events where one button is clicked
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  $("#add-animal").on("click", function (event) {
    event.preventDefault();

    // This line grabs the input from the textbox
    var animal = $("#animal-input").val().trim();

    // Adding the animal from the textbox to our array
    topics.push(animal);
    console.log(topics);

    // Calling renderButtons which handles the processing of our animal array
    renderButtons();
  }); // button clicked then make button
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Function for displaying the animal info
  // Using $(document).on instead of $(".animal").on to add event listeners to dynamically generated elements
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  $(document).on("click", ".animal", displayAnimalInfo);
  // Calling the renderButtons function to display the initial buttons
  renderButtons();
</script>